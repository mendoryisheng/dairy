
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç§å…»ç»“åˆç³»ç»Ÿç‰©èƒ½å¾ªç¯ä¸å¢äº§å¢æ•ˆå†³ç­–ç³»ç»Ÿ</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 14px;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 20px;
        }
        
        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }
        
        .card-title span {
            margin-right: 10px;
            font-size: 22px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #34495e;
            margin-bottom: 8px;
        }
        
        .form-input,
        .form-select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .slider-container {
            margin-top: 8px;
        }
        
        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 20px;
            color: white;
            text-align: center;
        }
        
        .metric-card.red {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .metric-card.yellow {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }
        
        .metric-card.green {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        
        .metric-card.blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .metric-card.orange {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        .metric-label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .metric-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .metric-unit {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        table thead {
            background: #f8f9fa;
        }
        
        table th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
        }
        
        table td {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        table tr.section-header {
            background: #f0f4ff;
            font-weight: 600;
        }
        
        table tr:hover {
            background: #f8f9fa;
        }
        
        .bar-chart {
            display: flex;
            align-items: flex-end;
            height: 250px;
            padding: 20px 0;
            gap: 15px;
        }
        
        .bar-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .bar {
            width: 100%;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 8px 8px 0 0;
            position: relative;
            transition: all 0.3s;
        }
        
        .bar:hover {
            opacity: 0.8;
        }
        
        .bar-value {
            position: absolute;
            top: -25px;
            width: 100%;
            text-align: center;
            font-size: 13px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .bar-label {
            font-size: 13px;
            color: #7f8c8d;
            text-align: center;
        }
        
        .pie-chart {
            display: flex;
            align-items: center;
            gap: 30px;
            padding: 20px;
        }
        
        .pie-visual {
            position: relative;
            width: 200px;
            height: 200px;
        }
        
        .pie-legend {
            flex: 1;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 10px;
        }
        
        .legend-text {
            font-size: 14px;
            color: #2c3e50;
        }
        
        .flow-chart {
            padding: 20px;
            position: relative;
        }
        
        .flow-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .flow-box {
            flex: 1;
            padding: 15px;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            font-weight: bold;
        }
        
        .flow-arrow {
            padding: 0 15px;
            font-size: 24px;
            color: #667eea;
        }
        
        .comparison-chart {
            padding: 20px;
        }
        
        .comparison-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 15px;
        }
        
        .comparison-label {
            width: 120px;
            font-size: 14px;
            color: #2c3e50;
            font-weight: 600;
        }
        
        .comparison-bar-container {
            flex: 1;
            height: 30px;
            background: #f0f0f0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .comparison-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-size: 12px;
            font-weight: bold;
            transition: width 0.5s ease;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .info-box h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .info-box ul {
            list-style: none;
            padding-left: 0;
        }
        
        .info-box li {
            color: #0d47a1;
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }
        
        .info-box li:before {
            content: "â€¢";
            position: absolute;
            left: 5px;
            font-weight: bold;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: white;
            font-size: 14px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ„ ç§å…»ç»“åˆç³»ç»Ÿç‰©èƒ½å¾ªç¯ä¸å¢äº§å¢æ•ˆå†³ç­–ç³»ç»Ÿ</h1>
            <p>åŸºäºCLEANERæ¨¡å‹å’ŒçœŸå®å‚æ•°çš„ç²¾ç¡®è®¡ç®— | Ym=6.5% | OMD=62.9% | B0=130 mÂ³/t VS</p>
        </div>

        <div class="main-grid">
            <!-- å·¦ä¾§ï¼šè¾“å…¥å‚æ•° -->
            <div>
                <div class="card">
                    <div class="card-title"><span>ğŸ“Š</span>åŸºç¡€ä¿¡æ¯</div>
                    <div class="form-group">
                        <label class="form-label">å¥¶ç‰›æ•°é‡ï¼ˆå¤´ï¼‰</label>
                        <input type="number" id="cattleNumber" class="form-input" value="100" min="1" max="10000" onchange="calculate()">
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ°”å€™åŒº</label>
                        <select id="climateZone" class="form-select" onchange="calculate()">
                            <option value="cool">å¯’å†· (&lt;15Â°C)</option>
                            <option value="temperate" selected>æ¸©å¸¦ (15-25Â°C)</option>
                            <option value="warm">æ¸©æš– (&gt;25Â°C)</option>
                        </select>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title"><span>ğŸŒ¾</span>æ—¥ç²®é…æ–¹</div>
                    <div class="form-group">
                        <label class="form-label">ç²—è›‹ç™½å«é‡ï¼š<span id="cpValue">16.0</span>%</label>
                        <div class="slider-container">
                            <input type="range" id="crudeProtein" class="slider" min="12" max="20" step="0.5" value="16" oninput="updateSlider('cp'); calculate()">
                            <div class="slider-label"><span>12%</span><span>20%</span></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å¹²ç‰©è´¨é‡‡é£Ÿé‡ï¼š<span id="dmiValue">20</span> kg/å¤©</label>
                        <div class="slider-container">
                            <input type="range" id="dmiIntake" class="slider" min="15" max="25" step="0.5" value="20" oninput="updateSlider('dmi'); calculate()">
                            <div class="slider-label"><span>15 kg</span><span>25 kg</span></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">äº§å¥¶é‡ï¼š<span id="milkValue">25</span> kg/å¤©</label>
                        <div class="slider-container">
                            <input type="range" id="milkYield" class="slider" min="15" max="40" step="1" value="25" oninput="updateSlider('milk'); calculate()">
                            <div class="slider-label"><span>15 kg</span><span>40 kg</span></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title"><span>ğŸ </span>åœˆèˆç®¡ç†</div>
                    <div class="form-group">
                        <label class="form-label">åœ°æ¿ç±»å‹</label>
                        <select id="floorType" class="form-select" onchange="calculate()">
                            <option value="solid" selected>å®å¿ƒåœ°æ¿ (NH3=23%)</option>
                            <option value="slatted">æ¼ç¼åœ°æ¿ (NH3=15%)</option>
                            <option value="litter">å«æ–™ç³»ç»Ÿ (NH3=8%)</option>
                        </select>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title"><span>â™»ï¸</span>ç²ªæ±¡å¤„ç†</div>
                    <div class="form-group">
                        <label class="form-label">å‚¨å­˜æ–¹å¼</label>
                        <select id="storageType" class="form-select" onchange="calculate()">
                            <option value="liquid" selected>æ•å£æ¶²æ€ (NH3=17%)</option>
                            <option value="solid">å›ºæ€å †å­˜ (NH3=17%)</option>
                            <option value="covered">è¦†ç›–å‚¨å­˜ (NH3=3.4%)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å¤„ç†æŠ€æœ¯</label>
                        <select id="treatmentMethod" class="form-select" onchange="calculate()">
                            <option value="storage" selected>å¸¸è§„å‚¨å­˜</option>
                            <option value="compost">å †è‚¥å¤„ç† (NH3=25.8%)</option>
                            <option value="anaerobic">åŒæ°§å‘é…µ (NH3=5.1%)</option>
                            <option value="direct">ç›´æ¥è¿˜ç”°</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">è¿˜ç”°æ–¹å¼</label>
                        <select id="fieldMethod" class="form-select" onchange="calculate()">
                            <option value="surface" selected>è¡¨é¢æ’’æ–½ (NH3=15%)</option>
                            <option value="injection">æ³¨å…¥å¼ (NH3=3%)</option>
                            <option value="compost">è…ç†Ÿåè¿˜ç”° (NH3=1%)</option>
                        </select>
                    </div>
                </div>
<div class="card">
    <div class="card-title"><span>ğŸŒ¾</span>ç²ªè‚¥è¿˜ç”°ä¸ä½œç‰©å¢äº§</div>
    <div class="form-group">
        <label class="form-label">ä½œç‰©ç±»å‹</label>
        <select id="cropType" class="form-select" onchange="calculate()">
            <option value="wheat">å°éº¦ (å¢äº§æ½œåŠ›é«˜)</option>
            <option value="maize">ç‰ç±³ (å¢äº§æ½œåŠ›ä¸­)</option>
        </select>
    </div>
    <div class="form-group">
        <label class="form-label">ç§æ¤é¢ç§¯ï¼ˆäº©ï¼‰</label>
        <input type="number" id="cropArea" class="form-input" value="500" min="0" max="10000" step="50" onchange="calculate()">
    </div>
    <div class="form-group">
        <label class="form-label">å¯¹ç…§äº§é‡ï¼ˆkg/äº©ï¼‰</label>
        <input type="number" id="baseYield" class="form-input" value="400" min="100" max="1000" step="10" onchange="calculate()">
        <small style="color: #7f8c8d; font-size: 12px;">å°éº¦å¹³å‡404 kg/äº©ï¼Œç‰ç±³å¹³å‡504 kg/äº©</small>
    </div>
    <div class="form-group">
        <label class="form-label">ç²ªè‚¥ç±»å‹</label>
        <select id="manureType" class="form-select" onchange="calculate()">
            <option value="cattle_compost">ç‰›ç²ªå †è‚¥ (æ¨è)</option>
            <option value="cattle_manure">ç‰›ç²ª (é²œ)</option>
            <option value="pig_compost">çŒªç²ªå †è‚¥</option>
            <option value="pig_manure">çŒªç²ª (ä¸æ¨è)</option>
        </select>
    </div>
</div>
            </div>

            <!-- å³ä¾§ï¼šç»“æœå±•ç¤º -->
            <div>
                <div class="metrics-grid">
                    <div class="metric-card red">
                        <div class="metric-label">æ€»CHâ‚„æ’æ”¾</div>
                        <div class="metric-value" id="totalCH4">0.0</div>
                        <div class="metric-unit">å¨/å¹´</div>
                    </div>
                    <div class="metric-card yellow">
                        <div class="metric-label">æ€»NHâ‚ƒæ’æ”¾</div>
                        <div class="metric-value" id="totalNH3">0.00</div>
                        <div class="metric-unit">å¨/å¹´</div>
                    </div>
                    <div class="metric-card blue">
                        <div class="metric-label">æ°®åˆ©ç”¨æ•ˆç‡</div>
                        <div class="metric-value" id="NUE">0.0</div>
                        <div class="metric-unit">%</div>
                    </div>
                    <div class="metric-card green">
                        <div class="metric-label">ç£·åˆ©ç”¨æ•ˆç‡</div>
                        <div class="metric-value" id="PUE">0.0</div>
                        <div class="metric-unit">%</div>
                    </div>
                    <div class="metric-card orange">
                        <div class="metric-label">æ€»Nâ‚‚Oæ’æ”¾</div>
                        <div class="metric-value" id="totalN2O">0.0</div>
                        <div class="metric-unit">kg/å¹´</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">å¯è¿˜ç”°æ°®</div>
                        <div class="metric-value" id="nFieldShort">0</div>
                        <div class="metric-unit">kg N/å¹´</div>
                    </div>
                </div>

                <div class="chart-grid">
                    <div class="card">
                        <div class="card-title">ğŸ“Š CHâ‚„æ’æ”¾å„é˜¶æ®µå æ¯”</div>
                        <div class="pie-chart">
                            <div class="pie-visual">
                                <canvas id="pieCanvas" width="200" height="200"></canvas>
                            </div>
                            <div class="pie-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #FF6B6B;"></div>
                                    <div class="legend-text">è‚ é“å‘é…µ <span id="entericPercent">0</span>%</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #4ECDC4;"></div>
                                    <div class="legend-text">åœˆèˆé˜¶æ®µ <span id="housingPercent">0</span>%</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #45B7D1;"></div>
                                    <div class="legend-text">ç²ªæ±¡ç®¡ç† <span id="storagePercent">0</span>%</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">ğŸ“Š å„ç±»æ°”ä½“æ’æ”¾é‡å¯¹æ¯”</div>
                        <div class="bar-chart" id="gasBarChart"></div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">ğŸ”„ å…»åˆ†æµåŠ¨ä¸è½¬åŒ–æ•ˆç‡</div>
                    <div class="flow-chart">
                        <div class="flow-item">
                            <div class="flow-box" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                é¥²æ–™å…»åˆ†æ‘„å…¥<br><span id="nIntakeFlow">0</span> kg N | <span id="pIntakeFlow">0</span> kg P
                            </div>
                            <div class="flow-arrow">â†’</div>
                            <div class="flow-box" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                                äº§å“ç•™å­˜<br><span id="nProductFlow">0</span> kg N | <span id="pProductFlow">0</span> kg P
                            </div>
                        </div>
                        <div class="flow-item">
                            <div class="flow-box" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                ç²ªå°¿æ’æ³„<br><span id="nExcretionFlow">0</span> kg N | <span id="pExcretionFlow">0</span> kg P
                            </div>
                            <div class="flow-arrow">â†’</div>
                            <div class="flow-box" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                                æ°”æ€æŸå¤±<br><span id="nLossFlow">0</span> kg N
                            </div>
                        </div>
                        <div class="flow-item">
                            <div class="flow-box" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                                å¯è¿˜ç”°å…»åˆ†<br><span id="nFieldFlow">0</span> kg N | <span id="pFieldFlow">0</span> kg P
                            </div>
                            <div class="flow-arrow">â†’</div>
                            <div class="flow-box" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                                æ›¿ä»£åŒ–è‚¥<br><span id="fertilizerSaved">0</span> kg
                            </div>
                        </div>
                    </div>
                </div>
<div class="card">
    <div class="card-title">ğŸŒ± ä½œç‰©å¢äº§æ•ˆæœé¢„æµ‹</div>
    <div class="metrics-grid" style="margin-bottom: 20px;">
        <div class="metric-card green">
            <div class="metric-label">åŒ–è‚¥æ›¿ä»£ç‡</div>
            <div class="metric-value" id="substitutionRate">0</div>
            <div class="metric-unit">%</div>
        </div>
        <div class="metric-card blue">
            <div class="metric-label">é¢„æœŸå¢äº§ç‡</div>
            <div class="metric-value" id="yieldIncreaseRate">0.0</div>
            <div class="metric-unit">%</div>
        </div>
        <div class="metric-card orange">
            <div class="metric-label">é¢„æœŸå¢äº§é‡</div>
            <div class="metric-value" id="yieldIncrease">0</div>
            <div class="metric-unit">kg</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">å¢äº§ä»·å€¼</div>
            <div class="metric-value" id="yieldValue">0</div>
            <div class="metric-unit">ä¸‡å…ƒ/å¹´</div>
        </div>
    </div>
    
    <div class="comparison-chart">
        <div class="comparison-row">
            <div class="comparison-label" style="width: 150px;">å¯¹ç…§äº§é‡</div>
            <div class="comparison-bar-container">
                <div class="comparison-bar" id="baseYieldBar" style="width: 100%; background: linear-gradient(90deg, #95a5a6, #7f8c8d);">
                    <span id="baseYieldText">0 kg</span>
                </div>
            </div>
        </div>
        <div class="comparison-row">
            <div class="comparison-label" style="width: 150px;">æ–½ç²ªè‚¥åäº§é‡</div>
            <div class="comparison-bar-container">
                <div class="comparison-bar" id="treatmentYieldBar" style="width: 100%;">
                    <span id="treatmentYieldText">0 kg</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="info-box" id="yieldAdvice" style="margin-top: 20px;">
        <h4>ğŸ’¡ å¢äº§å»ºè®®</h4>
        <ul id="adviceList"></ul>
    </div>
</div>

<div class="card">
    <div class="card-title">ğŸ’° ç»æµæ•ˆç›Šåˆ†æ</div>
    <table>
        <thead>
            <tr>
                <th>æ•ˆç›Šé¡¹ç›®</th>
                <th style="text-align: right;">æ•°å€¼</th>
                <th>å•ä½</th>
            </tr>
        </thead>
        <tbody>
            <tr class="section-header"><td colspan="3">å¢äº§æ”¶ç›Š</td></tr>
            <tr><td>æ€»å¢äº§é‡</td><td style="text-align: right;" id="econ_totalIncrease">0</td><td>kg/å¹´</td></tr>
            <tr><td>å¢äº§æ”¶å…¥</td><td style="text-align: right;" id="econ_income">0.00</td><td>ä¸‡å…ƒ/å¹´</td></tr>
            <tr class="section-header"><td colspan="3">èŠ‚è‚¥æ•ˆç›Š</td></tr>
            <tr><td>æ›¿ä»£åŒ–è‚¥Né‡</td><td style="text-align: right;" id="econ_fertSaved">0</td><td>kg/å¹´</td></tr>
            <tr><td>èŠ‚çœåŒ–è‚¥æˆæœ¬</td><td style="text-align: right;" id="econ_fertCost">0.00</td><td>ä¸‡å…ƒ/å¹´</td></tr>
            <tr class="section-header"><td colspan="3">ç»¼åˆæ•ˆç›Š</td></tr>
            <tr style="font-weight: bold; background: #e8f5e9;"><td>æ€»ç»æµæ•ˆç›Š</td><td style="text-align: right;" id="econ_total">0.00</td><td>ä¸‡å…ƒ/å¹´</td></tr>
            <tr><td>å•ä½é¢ç§¯æ•ˆç›Š</td><td style="text-align: right;" id="econ_perMu">0</td><td>å…ƒ/äº©/å¹´</td></tr>
        </tbody>
    </table>
</div>

                <div class="card">
                    <div class="card-title">âš¡ ä¸åŒå¤„ç†æ–¹å¼å‡æ’æ½œåŠ›å¯¹æ¯”</div>
                    <div class="comparison-chart" id="comparisonChart"></div>
                </div>

                <div class="card">
                    <div class="card-title">ğŸ“‹ æ’æ”¾ä¸å…»åˆ†è¯¦æƒ…</div>
                    <table>
                        <thead>
                            <tr>
                                <th>æŒ‡æ ‡ç±»åˆ«</th>
                                <th style="text-align: right;">æ•°å€¼</th>
                                <th>å•ä½</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="section-header"><td colspan="3">å…»åˆ†æ’æ³„é‡</td></tr>
                            <tr><td>æ°®æ’æ³„é‡</td><td style="text-align: right;" id="nExcretion">0</td><td>kg N/å¹´</td></tr>
                            <tr><td>ç£·æ’æ³„é‡</td><td style="text-align: right;" id="pExcretion">0</td><td>kg P/å¹´</td></tr>
                            <tr class="section-header"><td colspan="3">æ¸©å®¤æ°”ä½“æ’æ”¾</td></tr>
                            <tr><td>è‚ é“å‘é…µCHâ‚„</td><td style="text-align: right;" id="ch4Enteric">0</td><td>kg/å¹´</td></tr>
                            <tr><td>åœˆèˆé˜¶æ®µCHâ‚„</td><td style="text-align: right;" id="ch4Housing">0</td><td>kg/å¹´</td></tr>
                            <tr><td>ç²ªæ±¡ç®¡ç†CHâ‚„</td><td style="text-align: right;" id="ch4Storage">0</td><td>kg/å¹´</td></tr>
                            <tr><td>NHâ‚ƒæ’æ”¾</td><td style="text-align: right;" id="nh3Emission">0</td><td>kg/å¹´</td></tr>
                            <tr><td>Nâ‚‚Oæ’æ”¾</td><td style="text-align: right;" id="n2oEmission">0</td><td>kg/å¹´</td></tr>
                            <tr class="section-header"><td colspan="3">å¯è¿˜ç”°å…»åˆ†</td></tr>
                            <tr><td>å¯è¿˜ç”°æ°®é‡</td><td style="text-align: right;" id="nField">0</td><td>kg N/å¹´</td></tr>
                            <tr><td>å¯è¿˜ç”°ç£·é‡</td><td style="text-align: right;" id="pField">0</td><td>kg P/å¹´</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="info-box">
                    <h4>â„¹ï¸ ç³»ç»Ÿè¯´æ˜</h4>
                    <ul>
                        <li>æœ¬ç³»ç»ŸåŸºäºæ‚¨çš„Excelå‚æ•°æ–‡ä»¶æ„å»ºï¼Œä½¿ç”¨çœŸå®æ’æ”¾å› å­</li>
                        <li>è‚ é“å‘é…µï¼šYm=6.5%, OMD=62.9%, ç‰›å¥¶å«N=0.521%</li>
                        <li>åœˆèˆæ’æ”¾ï¼šå®å¿ƒåœ°æ¿NH3=23%, æ¼ç¼NH3=15%, å«æ–™NH3=8%</li>
                        <li>å‚¨å­˜æ’æ”¾ï¼šæ¶²æ€NH3=17%, è¦†ç›–NH3=3.4%</li>
                        <li>è¿˜ç”°æ’æ”¾ï¼šè¡¨æ–½NH3=15%, æ³¨å…¥NH3=3%, è…ç†ŸNH3=1%</li>
                        <li>æ²¼æ°”äº§ç”Ÿæ½œåŠ›B0=130 mÂ³/t VS (IPCCäºšæ´²é»˜è®¤å€¼)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
<div class="footer">
    Â© 2024 ç§å…»ç»“åˆç³»ç»Ÿç‰©èƒ½å¾ªç¯ä¸å¢äº§å¢æ•ˆå†³ç­–ç³»ç»Ÿ | åŸºäºCLEANERæ¨¡å‹å’ŒçœŸå®å‚æ•°
    <br>
    <div style="margin-top: 10px; font-size: 13px; opacity: 0.9;">
        ğŸ“Š æœ¬ç«™è®¿é—®ï¼š
        <span id="busuanzi_container_site_pv" style="margin: 0 10px;">
            æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"></span> æ¬¡
        </span>
        <span id="busuanzi_container_site_uv">
            è®¿å®¢æ•° <span id="busuanzi_value_site_uv"></span> äºº
        </span>
    </div>
</div>
    <script>
        // åŸºäºExcelæ–‡ä»¶çš„çœŸå®å‚æ•°
        const params = {
            dairy: {
                Ym: 6.5,        // ç”²çƒ·è½¬åŒ–å› å­ %
                OMD: 62.9,      // æœ‰æœºç‰©æ¶ˆåŒ–ç‡ %
                UE: 4,          // å°¿èƒ½ %
                B0: 130,        // æ²¼æ°”äº§ç”Ÿæ½œåŠ› mÂ³/t VS
                ManureN: 0.38,  // ç²ªä¾¿å«æ°®ç‡ %
                VS_ratio: 0.5   // C/VSæ¯”ä¾‹
            },
            milk: {
                N: 0.521,       // ç‰›å¥¶å«æ°®ç‡ % (ä»MilkNutè®¡ç®—çš„å¹³å‡å€¼)
                P: 0.088,       // ç‰›å¥¶å«ç£·ç‡ %
                fat: 3.99       // ä¹³è„‚ç‡ %
            },
            floorEF: {
                solid: { NH3: 23.0, N2O: 0.5, CH4_VS: 3 },
                slatted: { NH3: 15.0, N2O: 0.5, CH4_VS: 4 },
                litter: { NH3: 8.0, N2O: 0.5, CH4_VS: 5 }
            },
            treatmentEF: {
                compost: { NH3: 25.84, N2O: 0.26, CH4_reduction: 80 },
                anaerobic: { NH3: 5.1, N2O: 0.5, CH4_reduction: -20 },
                storage: { NH3: 0, N2O: 0, CH4_reduction: 0 }
            },
            storageEF: {
                liquid: { NH3: 17.0, N2O: 0.5 },
                solid: { NH3: 17.0, N2O: 0.5 },
                covered: { NH3: 3.4, N2O: 0.5 }
            },
            fieldEF: {
                surface: { NH3: 15.0, N2O: 0.64 },
                injection: { NH3: 3.0, N2O: 1.27 },
                compost: { NH3: 1.0, N2O: 1.0 }
            },
            MCF: {
                cool: { liquid: 10, solid: 1, covered: 8 },
                temperate: { liquid: 17, solid: 2, covered: 14 },
                warm: { liquid: 27, solid: 4, covered: 22 }
             },  
// åœ¨paramså¯¹è±¡ä¸­æ·»åŠ ä½œç‰©å¢äº§å‚æ•°ï¼ˆåŸºäºæ•°æ®åº“åˆ†æï¼‰
cropYield: {
    wheat: {
        baseYield_kgPerHa: 6068,  // å¹³å‡å¯¹ç…§äº§é‡ kg/ha
        baseYield_kgPerMu: 404,    // æ¢ç®—ä¸ºäº©
        nRate_kgPerHa: 180,        // æ¨èæ–½æ°®é‡ kg/ha
        price: 2.5,                // ä»·æ ¼ å…ƒ/kg
        yieldResponse: {
            'cattle_compost': {
                sr_0_25: -5.2, sr_25_50: -1.8, sr_50_75: -10.1, sr_75_100: 25.5
            },
            'cattle_manure': { 
                sr_0_25: -3.0, sr_25_50: -2.0, sr_50_75: -8.0, sr_75_100: 9.7
            },
            'pig_compost': { 
                sr_0_25: -4.0, sr_25_50: -1.0, sr_50_75: -7.0, sr_75_100: 20.3
            },
            'pig_manure': { 
                sr_0_25: -8.0, sr_25_50: -10.0, sr_50_75: -12.0, sr_75_100: -6.8
            }
        }
    },
    maize: {
        baseYield_kgPerHa: 7561,
        baseYield_kgPerMu: 504,
        nRate_kgPerHa: 220,
        price: 2.2,
        yieldResponse: {
            'cattle_compost': {
                sr_0_25: -2.1, sr_25_50: -12.2, sr_50_75: -7.2, sr_75_100: 10.8
            },
            'cattle_manure': { 
                sr_0_25: -3.5, sr_25_50: -8.0, sr_50_75: -6.0, sr_75_100: -5.2
            },
            'pig_compost': { 
                sr_0_25: -1.5, sr_25_50: -5.0, sr_50_75: -3.0, sr_75_100: 1.3
            },
            'pig_manure': { 
                sr_0_25: -10.0, sr_25_50: -18.0, sr_50_75: -15.0, sr_75_100: -14.5
            }
        }
    }
},
fertilizer: {
    nPrice: 3.5,  // å°¿ç´ ä»·æ ¼ å…ƒ/kg N (å°¿ç´ çº¦8å…ƒ/kgï¼Œå«N 46%)
    pPrice: 6.0,  // ç£·è‚¥ä»·æ ¼ å…ƒ/kg P
}
        };

        function updateSlider(type) {
            if (type === 'cp') {
                document.getElementById('cpValue').textContent = document.getElementById('crudeProtein').value;
            } else if (type === 'dmi') {
                document.getElementById('dmiValue').textContent = document.getElementById('dmiIntake').value;
            } else if (type === 'milk') {
                document.getElementById('milkValue').textContent = document.getElementById('milkYield').value;
            }
        }

        function calculate() {
            const cattleNumber = parseFloat(document.getElementById('cattleNumber').value);
            const climateZone = document.getElementById('climateZone').value;
            const crudeProtein = parseFloat(document.getElementById('crudeProtein').value);
            const dmiIntake = parseFloat(document.getElementById('dmiIntake').value);
            const milkYield = parseFloat(document.getElementById('milkYield').value);
            const floorType = document.getElementById('floorType').value;
            const storageType = document.getElementById('storageType').value;
            const treatmentMethod = document.getElementById('treatmentMethod').value;
            const fieldMethod = document.getElementById('fieldMethod').value;

            // 1. å…»åˆ†æ‘„å…¥å’Œæ’æ³„ (åŸºäºçœŸå®å‚æ•°)
            const nIntake = (dmiIntake * crudeProtein / 100) / 6.25;
            const pIntake = dmiIntake * 0.45 / 100;
            
            const milkN = milkYield * params.milk.N / 100;
            const milkP = milkYield * params.milk.P / 100;
            
            const nExcretion = nIntake - milkN;
            const pExcretion = pIntake - milkP;
            
            const NUE = (milkN / nIntake) * 100;
            const PUE = (milkP / pIntake) * 100;
            
            // 2. è‚ é“å‘é…µCH4 (ä½¿ç”¨çœŸå®Ymå€¼)
            const GE = dmiIntake * 18.45;  // MJ/å¤©
            const entericCH4 = (GE * params.dairy.Ym / 100) / 55.65;
            
            // 3. VSæ’æ³„å’Œåœˆèˆæ’æ”¾
            const vsExcretion = dmiIntake * 0.8 * (100 - params.dairy.OMD) / 100 + 
                               GE * params.dairy.UE / 100 / 18.45;
            
            const floorEF = params.floorEF[floorType];
            const housingNH3 = nExcretion * floorEF.NH3 / 100;
            const housingN2O = nExcretion * floorEF.N2O / 100;
            const housingCH4_VS = vsExcretion * floorEF.CH4_VS / 100;
            
            // 4. å‚¨å­˜é˜¶æ®µæ’æ”¾
            const mcfValue = params.MCF[climateZone][storageType];
            const storageCH4_base = vsExcretion * params.dairy.B0 / 1000 * 0.67 * (mcfValue / 100);
            
            const treatEF = treatmentMethod === 'storage' ? { NH3: 0, N2O: 0, CH4_reduction: 0 } : 
                           params.treatmentEF[treatmentMethod];
            
            const storageCH4 = storageCH4_base * (1 + treatEF.CH4_reduction / 100);
            
            const storageEF = params.storageEF[storageType];
            const storageNH3 = (nExcretion - housingNH3) * storageEF.NH3 / 100;
            const storageN2O = (nExcretion - housingNH3) * storageEF.N2O / 100;
            
            // 5. è¿˜ç”°æ’æ”¾
            const fieldEF = params.fieldEF[fieldMethod];
            const nRemaining = nExcretion - housingNH3 - storageNH3;
            const fieldNH3 = nRemaining * fieldEF.NH3 / 100;
            const fieldN2O = nRemaining * fieldEF.N2O / 100;
            
            // 6. å¹´åŒ–å¹¶ä¹˜ä»¥ç‰›å¤´æ•°
            const totalEntericCH4 = entericCH4 * 365 * cattleNumber;
            const totalHousingCH4 = housingCH4_VS * 365 * cattleNumber;
            const totalStorageCH4 = storageCH4 * 365 * cattleNumber;
            const totalCH4 = totalEntericCH4 + totalHousingCH4 + totalStorageCH4;
            
            const totalNH3 = (housingNH3 + storageNH3 + fieldNH3) * 365 * cattleNumber;
            const totalN2O = (housingN2O + storageN2O + fieldN2O) * 365 * cattleNumber;
            
            const nToField = (nRemaining - fieldNH3 - fieldN2O) * 365 * cattleNumber;
            const pToField = pExcretion * 365 * cattleNumber * 0.95;
            
            const totalNExcretion = nExcretion * 365 * cattleNumber;
            const totalPExcretion = pExcretion * 365 * cattleNumber;
            
            const totalNIntake = nIntake * 365 * cattleNumber;
            const totalPIntake = pIntake * 365 * cattleNumber;
            const totalNProduct = milkN * 365 * cattleNumber;
            const totalPProduct = milkP * 365 * cattleNumber;
            const totalNLoss = totalNH3 + totalN2O;
            const fertilizerSaved = nToField * 3;

            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('totalCH4').textContent = (totalCH4 / 1000).toFixed(1);
            document.getElementById('totalNH3').textContent = (totalNH3 / 1000).toFixed(2);
            document.getElementById('NUE').textContent = NUE.toFixed(1);
            document.getElementById('PUE').textContent = PUE.toFixed(1);
            document.getElementById('totalN2O').textContent = totalN2O.toFixed(0);
            document.getElementById('nFieldShort').textContent = nToField.toFixed(0);
            
            document.getElementById('nExcretion').textContent = totalNExcretion.toFixed(0);
            document.getElementById('pExcretion').textContent = totalPExcretion.toFixed(0);
            document.getElementById('ch4Enteric').textContent = totalEntericCH4.toFixed(0);
            document.getElementById('ch4Housing').textContent = totalHousingCH4.toFixed(0);
            document.getElementById('ch4Storage').textContent = totalStorageCH4.toFixed(0);
            document.getElementById('nh3Emission').textContent = totalNH3.toFixed(0);
            document.getElementById('n2oEmission').textContent = totalN2O.toFixed(0);
            document.getElementById('nField').textContent = nToField.toFixed(0);
            document.getElementById('pField').textContent = pToField.toFixed(0);
            
            document.getElementById('nIntakeFlow').textContent = totalNIntake.toFixed(0);
            document.getElementById('pIntakeFlow').textContent = totalPIntake.toFixed(0);
            document.getElementById('nProductFlow').textContent = totalNProduct.toFixed(0);
            document.getElementById('pProductFlow').textContent = totalPProduct.toFixed(0);
            document.getElementById('nExcretionFlow').textContent = totalNExcretion.toFixed(0);
            document.getElementById('pExcretionFlow').textContent = totalPExcretion.toFixed(0);
            document.getElementById('nLossFlow').textContent = totalNLoss.toFixed(0);
            document.getElementById('nFieldFlow').textContent = nToField.toFixed(0);
            document.getElementById('pFieldFlow').textContent = pToField.toFixed(0);
            document.getElementById('fertilizerSaved').textContent = fertilizerSaved.toFixed(0);

            drawPieChart(totalEntericCH4, totalHousingCH4, totalStorageCH4);
            drawBarChart(totalCH4, totalNH3, totalN2O);
            drawComparisonChart(totalCH4);
// åœ¨calculate()å‡½æ•°çš„æœ€åï¼ŒdrawComparisonChartä¹‹åæ·»åŠ ï¼š

// ========== ç²ªè‚¥è¿˜ç”°å¢äº§æ•ˆæœè®¡ç®— ==========
const cropType = document.getElementById('cropType').value;
const cropArea = parseFloat(document.getElementById('cropArea').value);
const baseYield_mu = parseFloat(document.getElementById('baseYield').value);
const manureType = document.getElementById('manureType').value;

// è½¬æ¢ä¸ºå…¬é¡·
const cropArea_ha = cropArea / 15;
const baseYield_ha = baseYield_mu * 15;

// è·å–ä½œç‰©å‚æ•°
const cropParams = params.cropYield[cropType];

// è®¡ç®—å¯è¿˜ç”°æ°®é‡ï¼ˆkg N/haï¼‰
const nToField_ha = nToField / cropArea_ha;

// è®¡ç®—åŒ–è‚¥æ›¿ä»£ç‡
const recommendedN = cropParams.nRate_kgPerHa;
const substitutionRate = Math.min((nToField_ha / recommendedN) * 100, 100);

// æ ¹æ®æ›¿ä»£ç‡åŒºé—´ç¡®å®šå¢äº§ç‡
let yieldIncreaseRate = 0;
const responseData = cropParams.yieldResponse[manureType];

if (substitutionRate < 25) {
    yieldIncreaseRate = responseData.sr_0_25;
} else if (substitutionRate < 50) {
    yieldIncreaseRate = responseData.sr_25_50;
} else if (substitutionRate < 75) {
    yieldIncreaseRate = responseData.sr_50_75;
} else {
    yieldIncreaseRate = responseData.sr_75_100;
}

// è®¡ç®—å¢äº§é‡
const yieldIncrease_ha = baseYield_ha * yieldIncreaseRate / 100;
const yieldIncrease_total = yieldIncrease_ha * cropArea_ha;
const treatmentYield_ha = baseYield_ha + yieldIncrease_ha;

// è®¡ç®—ç»æµæ•ˆç›Š
const cropPrice = cropParams.price;
const yieldValue = (yieldIncrease_total * cropPrice) / 10000; // ä¸‡å…ƒ
const fertSaved = nToField;
const fertCostSaved = (fertSaved * params.fertilizer.nPrice) / 10000; // ä¸‡å…ƒ
const totalEconomicBenefit = yieldValue + fertCostSaved;
const benefitPerMu = (totalEconomicBenefit * 10000) / cropArea;

// æ›´æ–°æ˜¾ç¤º
document.getElementById('substitutionRate').textContent = substitutionRate.toFixed(0);
document.getElementById('yieldIncreaseRate').textContent = yieldIncreaseRate.toFixed(1);
document.getElementById('yieldIncrease').textContent = yieldIncrease_total.toFixed(0);
document.getElementById('yieldValue').textContent = yieldValue.toFixed(2);

// æ›´æ–°äº§é‡å¯¹æ¯”å›¾
const maxYield = Math.max(baseYield_ha, treatmentYield_ha);
const baseWidth = (baseYield_ha / maxYield * 100).toFixed(0);
const treatWidth = (treatmentYield_ha / maxYield * 100).toFixed(0);
document.getElementById('baseYieldBar').style.width = baseWidth + '%';
document.getElementById('baseYieldText').textContent = baseYield_ha.toFixed(0) + ' kg/ha';
document.getElementById('treatmentYieldBar').style.width = treatWidth + '%';
document.getElementById('treatmentYieldText').textContent = treatmentYield_ha.toFixed(0) + ' kg/ha';

// æ›´æ–°ç»æµæ•ˆç›Šè¡¨æ ¼
document.getElementById('econ_totalIncrease').textContent = yieldIncrease_total.toFixed(0);
document.getElementById('econ_income').textContent = yieldValue.toFixed(2);
document.getElementById('econ_fertSaved').textContent = fertSaved.toFixed(0);
document.getElementById('econ_fertCost').textContent = fertCostSaved.toFixed(2);
document.getElementById('econ_total').textContent = totalEconomicBenefit.toFixed(2);
document.getElementById('econ_perMu').textContent = benefitPerMu.toFixed(0);

// ç”Ÿæˆå¢äº§å»ºè®®
generateYieldAdvice(cropType, manureType, substitutionRate, yieldIncreaseRate, nToField_ha, recommendedN);
        }
function generateYieldAdvice(cropType, manureType, substitutionRate, yieldIncreaseRate, nToField_ha, recommendedN) {
    const adviceList = document.getElementById('adviceList');
    const cropName = cropType === 'wheat' ? 'å°éº¦' : 'ç‰ç±³';
    const manureNames = {
        'cattle_compost': 'ç‰›ç²ªå †è‚¥',
        'cattle_manure': 'ç‰›ç²ª',
        'pig_compost': 'çŒªç²ªå †è‚¥',
        'pig_manure': 'çŒªç²ª'
    };
    
    let advices = [];
    
    // æ›¿ä»£ç‡è¯„ä¼°
    if (substitutionRate < 50) {
        advices.push(`âš ï¸ å½“å‰åŒ–è‚¥æ›¿ä»£ç‡ä»…${substitutionRate.toFixed(0)}%ï¼Œå»ºè®®å¢åŠ å¥¶ç‰›å…»æ®–è§„æ¨¡æˆ–å‡å°‘ç§æ¤é¢ç§¯ä»¥æé«˜æ›¿ä»£ç‡`);
        advices.push(`ğŸ“Š å½“å‰å¯è¿˜ç”°æ°®é‡${nToField_ha.toFixed(0)} kg/haï¼Œæ¨èæ–½æ°®é‡${recommendedN} kg/ha`);
    } else if (substitutionRate < 75) {
        advices.push(`âš ï¸ å½“å‰åŒ–è‚¥æ›¿ä»£ç‡${substitutionRate.toFixed(0)}%å¤„äºä¸­ç­‰æ°´å¹³ï¼Œå»ºè®®æå‡è‡³75%ä»¥ä¸Šä»¥è·å¾—æ›´å¥½å¢äº§æ•ˆæœ`);
    } else {
        advices.push(`âœ… å½“å‰åŒ–è‚¥æ›¿ä»£ç‡${substitutionRate.toFixed(0)}%å¤„äºé«˜æ°´å¹³ï¼Œå¢äº§æ•ˆæœæœ€ä½³`);
    }
    
    // å¢äº§æ•ˆæœè¯„ä¼°
    if (yieldIncreaseRate > 15) {
        advices.push(`ğŸŒŸ é¢„æœŸå¢äº§ç‡${yieldIncreaseRate.toFixed(1)}%ï¼Œå¢äº§æ•ˆæœä¼˜ç§€ï¼`);
    } else if (yieldIncreaseRate > 5) {
        advices.push(`âœ“ é¢„æœŸå¢äº§ç‡${yieldIncreaseRate.toFixed(1)}%ï¼Œå¢äº§æ•ˆæœè‰¯å¥½`);
    } else if (yieldIncreaseRate > 0) {
        advices.push(`âš ï¸ é¢„æœŸå¢äº§ç‡${yieldIncreaseRate.toFixed(1)}%ï¼Œå¢äº§æ•ˆæœä¸€èˆ¬ï¼Œå»ºè®®ä¼˜åŒ–ç®¡ç†`);
    } else {
        advices.push(`âŒ é¢„æœŸå‡äº§${Math.abs(yieldIncreaseRate).toFixed(1)}%ï¼Œå»ºè®®è°ƒæ•´æ–¹æ¡ˆ`);
    }
    
    // ç²ªè‚¥ç±»å‹å»ºè®®
    if (cropType === 'wheat') {
        if (manureType === 'cattle_compost') {
            advices.push(`â­ ${manureNames[manureType]}æ˜¯å°éº¦çš„æœ€ä½³é€‰æ‹©ï¼Œé«˜æ›¿ä»£ç‡ä¸‹å¯å¢äº§20-30%`);
        } else if (manureType === 'pig_manure') {
            advices.push(`âš ï¸ ä¸æ¨èå°éº¦ä½¿ç”¨${manureNames[manureType]}ï¼Œå»ºè®®æ”¹ç”¨ç‰›ç²ªå †è‚¥æˆ–çŒªç²ªå †è‚¥`);
        } else {
            advices.push(`âœ“ ${manureNames[manureType]}å¯¹å°éº¦æœ‰ä¸€å®šå¢äº§æ•ˆæœ`);
        }
    } else {
        if (manureType === 'cattle_compost') {
            advices.push(`â­ ${manureNames[manureType]}æ˜¯ç‰ç±³çš„æ¨èé€‰æ‹©ï¼Œé«˜æ›¿ä»£ç‡ä¸‹å¯å¢äº§10%å·¦å³`);
        } else if (manureType === 'pig_manure') {
            advices.push(`âŒ å¼ºçƒˆä¸æ¨èç‰ç±³ä½¿ç”¨${manureNames[manureType]}ï¼Œå„æ›¿ä»£ç‡ä¸‹å‡å‡äº§`);
        }
    }
    
    // ç®¡ç†å»ºè®®
    if (substitutionRate >= 75 && yieldIncreaseRate > 0) {
        advices.push(`ğŸ’¡ å»ºè®®ï¼šå……åˆ†è…ç†Ÿåè¿˜ç”°ï¼ŒåŸºè‚¥ä¸ºä¸»ï¼Œæ’­å‰2-4å‘¨æ–½ç”¨`);
    } else if (substitutionRate < 75) {
        advices.push(`ğŸ’¡ å»ºè®®ï¼šå¯é…åˆå°‘é‡é€Ÿæ•ˆåŒ–è‚¥ï¼Œç¡®ä¿ä½œç‰©æ—©æœŸå…»åˆ†ä¾›åº”`);
    }
    
    adviceList.innerHTML = advices.map(advice => `<li>${advice}</li>`).join('');
}

        function drawPieChart(enteric, housing, storage) {
            const total = enteric + housing + storage;
            const entericPercent = (enteric / total * 100).toFixed(0);
            const housingPercent = (housing / total * 100).toFixed(0);
            const storagePercent = (storage / total * 100).toFixed(0);
            
            document.getElementById('entericPercent').textContent = entericPercent;
            document.getElementById('housingPercent').textContent = housingPercent;
            document.getElementById('storagePercent').textContent = storagePercent;
            
            const canvas = document.getElementById('pieCanvas');
            const ctx = canvas.getContext('2d');
            const centerX = 100;
            const centerY = 100;
            const radius = 80;
            
            ctx.clearRect(0, 0, 200, 200);
            
            let startAngle = 0;
            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1'];
            const values = [enteric, housing, storage];
            
            values.forEach((value, index) => {
                const sliceAngle = (value / total) * 2 * Math.PI;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, startAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = colors[index];
                ctx.fill();
                ctx.strokeStyle = 'white';
                ctx.lineWidth = 2;
                ctx.stroke();
                startAngle += sliceAngle;
            });
        }

        function drawBarChart(ch4, nh3, n2o) {
            const maxValue = Math.max(ch4, nh3, n2o);
            const container = document.getElementById('gasBarChart');
            const data = [
                { label: 'CHâ‚„', value: ch4 },
                { label: 'NHâ‚ƒ', value: nh3 },
                { label: 'Nâ‚‚O', value: n2o }
            ];
            container.innerHTML = data.map(item => {
                const height = (item.value / maxValue * 200).toFixed(0);
                return `<div class="bar-item"><div class="bar" style="height: ${height}px;"><div class="bar-value">${item.value.toFixed(0)}</div></div><div class="bar-label">${item.label}</div></div>`;
            }).join('');
        }

        function drawComparisonChart(currentCH4) {
            const container = document.getElementById('comparisonChart');
            const baseline = currentCH4;
            const data = [
                { label: 'å½“å‰æ–¹æ¡ˆ', value: baseline, percent: 100 },
                { label: 'åŒæ°§å‘é…µ', value: baseline * 0.8, percent: 80 },
                { label: 'å †è‚¥å¤„ç†', value: baseline * 0.2, percent: 20 },
                { label: 'è¦†ç›–å‚¨å­˜', value: baseline * 0.6, percent: 60 }
            ];
            container.innerHTML = data.map(item => `
                <div class="comparison-row">
                    <div class="comparison-label">${item.label}</div>
                    <div class="comparison-bar-container">
                        <div class="comparison-bar" style="width: ${item.percent}%">${item.value.toFixed(0)} kg</div>
                    </div>
                </div>
            `).join('');
        }

        window.onload = function() {
            calculate();
        };
</script>
    
    <!-- ä¸è’œå­è®¿é—®ç»Ÿè®¡ -->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</body>
</html>

